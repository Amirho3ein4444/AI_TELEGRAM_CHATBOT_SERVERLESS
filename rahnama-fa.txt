سلام! خوش اومدی به راهنمای ساخت ربات چت رایگان توی تلگرام. توی این راهنما، قدم‌به‌قدم بهت یاد می‌دم چطور رباتت رو بسازی و راه‌اندازی کنی. تو یه فایل دانلود کردی که شامل کد main.js هست و من بر اساس اون کد و توضیحاتت، همه‌چیز رو برات ساده و واضح می‌کنم. نگران نباش، حتی اگه مبتدی باشی، با این راهنما می‌تونی رباتت رو بسازی!
رباتی که قراره بسازی، از Appwrite Cloud برای ذخیره اطلاعات و اجرای برنامه، OpenRouter برای جواب‌های هوشمند و تلگرام برای چت با آدما استفاده می‌کنه. همه‌چیز رو مرحله‌به‌مرحله توضیح می‌دم. بریم شروع کنیم!
چیزایی که قبل از شروع نیاز داری
برای ساخت این ربات، فقط به چند تا چیز ساده نیاز داری:
کامپیوتر با اینترنت: یه لپ‌تاپ یا کامپیوتر که به اینترنت وصل باشه.

مرورگر وب: مثل گوگل کروم، فایرفاکس یا سافاری.

تلگرام: نصب‌شده روی گوشی یا کامپیوترت (اگه نداری، از telegram.org دانلود کن).

ایمیل: برای ثبت‌نام توی سایت‌ها.

کد main.js که داری (همون که بهم دادی).

همین کافیه! حالا بریم سراغ مراحل.
قدم ۱: ثبت‌نام توی Appwrite Cloud
Appwrite Cloud یه سرویس رایگان و قدرتمنده که مثل مغز رباتت عمل می‌کنه. اطلاعات رو نگه می‌داره و برنامه‌ت رو اجرا می‌کنه.
مرورگر رو باز کن: یه مرورگر (مثل کروم) باز کن.

برو به Appwrite: توی نوار آدرس بنویس https://appwrite.io/ و Enter بزن.

ثبت‌نام کن:
گوشه‌ی بالای سمت راست، دکمه‌ی Sign Up (ثبت‌نام) رو بزن.

اگه حساب گوگل داری، روی Sign up with Google کلیک کن و با گوگل ثبت‌نام کن.

یا روی Sign up with Email بزن، یه ایمیل و رمز وارد کن.

ثبت‌نام رو تموم کن:
اگه با ایمیل ثبت‌نام کردی، برو توی ایمیلت، یه لینک تأیید میاد، روش کلیک کن.

وارد شو: برگرد به https://appwrite.io/، روی Log In (ورود) بزن و با ایمیل و رمزت (یا گوگل) وارد شو.

حالا توی صفحه‌ی اصلی Appwrite هستی!
قدم ۲: ساختن پروژه توی Appwrite Cloud
پروژه مثل یه فضای کاری برای رباتته.
صفحه‌ی اصلی رو پیدا کن: توی Appwrite، یه دکمه‌ی بزرگ می‌بینی که نوشته Create Project (ساخت پروژه).

پروژه رو بساز:
روی دکمه کلیک کن.

توی کادر Project Name (اسم پروژه)، یه اسم مثل ربات من بنویس.

دکمه‌ی آبی Create (ساختن) رو بزن.

صبر کن: چند ثانیه طول می‌کشه تا پروژه‌ت آماده شه. بعدش یه صفحه‌ی جدید با اسم پروژه‌ت باز می‌شه.

پروژه‌ت آماده‌ست!
قدم ۳: راه‌اندازی پایگاه داده توی Appwrite
رباتت نیاز داره اطلاعات رو یه جایی نگه داره (مثل کاربرها، چت‌ها و جلسات). توی Appwrite، این کار با پایگاه داده و مجموعه‌ها (مثل پوشه‌ها) انجام می‌شه. باید سه تا مجموعه بسازی: کاربرها، جلسه‌ها و چت‌ها.
۳.۱ ساخت مجموعه‌ی "کاربرها"
اینجا اطلاعات کسایی که از رباتت استفاده می‌کنن رو نگه می‌داری.
برو به پایگاه داده: توی صفحه‌ی پروژه‌ت، سمت چپ روی Database (پایگاه داده) کلیک کن (آیکونش مثل یه کمد کوچیکه).

مجموعه بساز:
دکمه‌ی نارنجی Add Collection (اضافه کردن مجموعه) رو بزن.

توی کادر Name (اسم)، بنویس کاربرها (با "ک" بزرگ).

دکمه‌ی آبی Create (ساختن) رو بزن.

ویژگی‌ها رو اضافه کن:
توی مجموعه‌ی کاربرها، دکمه‌ی نارنجی Add Attribute (اضافه کردن ویژگی) رو بزن.

ویژگی‌ها رو یکی‌یکی بساز:
telegramId:
نوع: String (رشته).

کلید: telegramId (همه کوچیک).

اندازه: 255.

لازم؟: تیک Required (لازم) رو بزن.

Create رو بزن.

username:
نوع: String.

کلید: username.

اندازه: 255.

لازم؟: تیک Required رو نزن.

Create رو بزن.

createdAt:
نوع: DateTime (تاریخ و ساعت).

کلید: createdAt.

لازم؟: تیک Required رو بزن.

Create رو بزن.

چک کن: باید سه تا ویژگی ببینی: telegramId, username, createdAt.

۳.۲ ساخت مجموعه‌ی "جلسه‌ها"
اینجا جلسات چت کاربرها رو مدیریت می‌کنی.
برگرد عقب: بالای صفحه، روی Collections (مجموعه‌ها) کلیک کن.

مجموعه بساز:
دکمه‌ی Add Collection رو بزن.

اسم: جلسه‌ها (با "ج" بزرگ).

Create رو بزن.

ویژگی‌ها رو اضافه کن:
userId:
نوع: String.

کلید: userId.

اندازه: 255.

لازم؟: تیک Required رو بزن.

Create رو بزن.

active:
نوع: Boolean (درست/غلط).

کلید: active.

مقدار پیش‌فرض: true.

لازم؟: تیک Required رو بزن.

Create رو بزن.

createdAt:
نوع: DateTime.

کلید: createdAt.

لازم؟: تیک Required رو بزن.

Create رو بزن.

چک کن: باید userId, active, createdAt رو ببینی.

۳.۳ ساخت مجموعه‌ی "چت‌ها"
اینجا پیام‌های چت رو نگه می‌داری.
برگرد عقب: روی Collections کلیک کن.

مجموعه بساز:
اسم: چت‌ها (با "چ" بزرگ).

Create رو بزن.

ویژگی‌ها رو اضافه کن:
sessionId:
نوع: String.

کلید: sessionId.

اندازه: 255.

لازم؟: تیک Required رو بزن.

Create رو بزن.

userId:
نوع: String.

کلید: userId.

اندازه: 255.

لازم؟: تیک Required رو بزن.

Create رو بزن.

role:
نوع: String.

کلید: role.

اندازه: 255.

لازم؟: تیک Required رو بزن.

Create رو بزن.

content:
نوع: String.

کلید: content.

اندازه: 10000 (برای پیام‌های بلند).

لازم؟: تیک Required رو بزن.

Create رو بزن.

createdAt:
نوع: DateTime.

کلید: createdAt.

لازم؟: تیک Required رو بزن.

Create رو بزن.

چک کن: باید sessionId, userId, role, content, createdAt رو ببینی.

۳.۴ شماره‌ی مجموعه‌ها رو نگه دار
هر مجموعه یه Collection ID داره که توی کدت نیازش داری.
برو به مجموعه‌ها: توی بخش Database، سه تا مجموعه‌ت رو می‌بینی.

شماره‌ها رو کپی کن:
روی کاربرها کلیک کن، Collection ID (مثل 67f64d80000eb41830cf) رو کپی کن و توی یه فایل متنی (مثل نوت‌پد) بنویس: "شماره مجموعه کاربرها".

برای جلسه‌ها و چت‌ها هم همین کار رو بکن و بنویس: "شماره مجموعه جلسه‌ها" و "شماره مجموعه چت‌ها".

امن نگهشون دار: این شماره‌ها رو گم نکن!

قدم ۴: راه‌اندازی OpenRouter
OpenRouter یه سرویس رایگان برای جواب‌های هوشمنده.
برو به OpenRouter: توی مرورگر بنویس https://openrouter.ai/ و Enter بزن.

ثبت‌نام کن:
روی Sign Up (ثبت‌نام) کلیک کن.

با گوگل یا ایمیل ثبت‌نام کن.

تأیید کن: اگه با ایمیل ثبت‌نام کردی، لینک تأیید رو توی ایمیلت بزن.

وارد شو: با مشخصاتت وارد شو.

کلید بگیر:
سمت چپ، روی Keys (کلیدها) کلیک کن.

دکمه‌ی Create Key (ساخت کلید) رو بزن.

اسم: کلید ربات.

روی Generate (تولید) کلیک کن.

کلید (مثل sk-or-abc123xyz) رو کپی کن و توی فایل متنیت بنویس: "کلید OpenRouter".

قدم ۵: ساخت ربات توی تلگرام
تلگرام جاییه که رباتت با آدما حرف می‌زنه.
تلگرام رو باز کن: روی گوشی یا کامپیوترت تلگرام رو باز کن.

BotFather رو پیدا کن:
توی جستجو بنویس BotFather و چتش رو باز کن.

بنویس /start و Enter بزن.

ربات جدید بساز:
بنویس /newbot و Enter بزن.

اسم ربات: مثلاً ربات باحالم.

نام کاربری: مثلاً @ربات_باحالم_بات (باید با "Bot" تموم شه).

توکن رو بگیر:
BotFather یه توکن می‌ده (مثل 123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11).

کپی‌ش کن و توی فایل متنیت بنویس: "توکن ربات تلگرام".

تست کن: توی تلگرام، رباتت رو جستجو کن و /start بزن (هنوز جواب نمی‌ده، نگران نباش!).

قدم ۶: راه‌اندازی گیت‌هاب
گیت‌هاب جاییه که کدت رو نگه می‌داری.
برو به گیت‌هاب: توی مرورگر بنویس https://github.com/ و Enter بزن.

ثبت‌نام کن:
روی Sign Up کلیک کن.

نام کاربری (مثل اسمم123)، ایمیل و رمز بنویس.

مراحل رو دنبال کن و تأیید کن.

وارد شو: با مشخصاتت وارد شو.

مخزن بساز:
بالای سمت راست، روی + بزن و New repository (مخزن جدید) رو انتخاب کن.

اسم: ربات-چتم.

Public (عمومی) رو انتخاب کن.

تیک Add a README file رو بزن.

دکمه‌ی سبز Create repository رو بزن.

قدم ۷: ساختن تابع بدون سرور توی Appwrite
تابع بدون سرور همون برنامه‌ایه که رباتت رو زنده می‌کنه.
۷.۱ تابع جدید بساز
برو به تابع‌ها: توی پروژه‌ت، روی Functions (تابع‌ها) کلیک کن.

تابع بساز:
دکمه‌ی Create Function رو بزن.

اسم: تابع ربات.

محیط اجرا: Node.js 18 (یا جدیدترین نسخه).

Next رو بزن.

به گیت‌هاب وصل شو:
زیر Deployment Source، GitHub رو انتخاب کن.

روی Connect GitHub بزن و با مشخصات گیت‌هابت وارد شو.

مخزن‌ت (مثل ربات-چتم) رو انتخاب کن و Create بزن.

۷.۲ کدت رو اضافه کن
برو به مخزن‌ت: توی گیت‌هاب، برو به مخزن‌ت (مثل https://github.com/اسمم123/ربات-چتم).

فایل بساز:
روی Add file بزن و Create new file رو انتخاب کن.

اسم: src/main.js.

کد main.js رو که داری، کپی کن و توی کادر بچسبون.

پایین صفحه، Commit new file رو بزن.

۷.۳ تنظیمات رو بذار
تابع‌ت به متغیرهای محیطی نیاز داره:
برو به تابع‌ت: توی Appwrite، روی تابع ربات کلیک کن و تب Settings (تنظیمات) رو بزن.

متغیرها رو اضافه کن:
APPWRITE_ENDPOINT: https://cloud.appwrite.io/v1.

APPWRITE_PROJECT_ID: توی صفحه‌ی اصلی پروژه‌ت، Project ID رو کپی کن.

APPWRITE_API_KEY:
توی پروژه‌ت، سمت چپ روی Settings بزن.

API Keys > Add API Key.

اسم: کلید ربات.

دسترسی‌ها: databases.read, databases.write, functions.read.

کلید رو کپی کن.

OPENROUTER_API_KEY: از فایل متنیت.

TELEGRAM_TOKEN: از فایل متنیت.

DB_ID: توی Database، بالای صفحه Database ID رو کپی کن.

USERS_COLLECTION: شماره مجموعه کاربرها.

SESSIONS_COLLECTION: شماره مجموعه جلسه‌ها.

CHATS_COLLECTION: شماره مجموعه چت‌ها.

ذخیره کن: دکمه‌ی Update رو بزن.

قدم ۸: وصل کردن تلگرام به تابع‌ت (وب‌هوک)
آدرس تابع‌ت رو بگیر: توی Functions > تابع ربات > Settings، Function Domain (مثل https://67f6ead918e72f1f30f4.appwrite.global) رو کپی کن.

وب‌هوک رو تنظیم کن:
توی مرورگر، اینو بنویس:

https://api.telegram.org/bot<توکن رباتت>/setWebhook?url=<آدرس تابع‌ت>

مثلاً:

https://api.telegram.org/bot123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11/setWebhook?url=https://67f6ead918e72f1f30f4.appwrite.global

Enter بزن.

باید ببینی: {"ok":true,"result":true,"description":"Webhook was set"}.

قدم ۹: تست ربات
تلگرام رو باز کن: رباتت رو پیدا کن (مثل @ربات_باحالم_بات).

پیام بفرست: /start یا "سلام" بنویس.

صبر کن: ربات باید جواب بده! اگه نداد:
توی Appwrite، برو به Functions > تابع ربات > Executions.

خطاها رو چک کن و تنظیمات رو درست کن.

قدم ۱۰: اشتراک‌گذاری توی گیت‌هاب (اختیاری)
اگه می‌خوای رباتت عمومی باشه:
README رو به‌روز کن:
توی مخزن‌ت، روی README.md بزن و ویرایش کن:

# ربات چتم
یه ربات چت رایگان با Appwrite، OpenRouter و تلگرام.
## چطور استفاده کنم؟
راهنما رو دنبال کن!

Commit changes بزن.

تموم شد!
تبریک می‌گم! رباتت آماده‌ست. حالا می‌تونی باهاش چت کنی، پیام بفرستی و از جواب‌های هوشمندش لذت ببری. اگه مشکلی پیش اومد، مراحل رو دوباره چک کن یا توی دیسکورد Appwrite کمک بخواه. موفق باشی!

